<!DOCTYPE html>
<html>
<head>
	<title>Home</title>
	<meta charset= "UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<link href = "https://code.jquery.com/ui/1.10.4/themes/ui-lightness/jquery-ui.css" rel = "stylesheet">
	<script src = "https://code.jquery.com/ui/1.10.4/jquery-ui.js"></script>
	<style type="text/css">
		.datepicker{z-index: 9999999 !important;}
		div.active{background-color: #005500; }
		.ui-datepicker .ui-datepicker-title select {color: #000;}
	</style>
</head>
<body>
<div class="container-fluid">
		<!--Header -->
	<div class="jumbtron" style="background-color:purple; text-align: center; color: white; padding: 15px;">
		<div class="row">
			<h2 class="col-sm-9">Hospital Management</h2>
			<ul class="nav nav-pills col-sm-3">
				<li class="active"><a href="home.html">Home</a> </li>
				<li><a href="#" id="rg" data-toggle="modal" data-target="#registerModal" style="color: white;">Register</a> </li>
				<li><a href="#" id="lg" data-toggle="modal" data-target="#loginModal" style="color: white;">Login</a> </li>
			</ul>
		</div> 
	</div>
		<!--Carousel-->
	<div id="myCarousel" class="carousel slide" data-ride="carousel">
 		<!-- Indicators -->
		<ol class="carousel-indicators">
			<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
			<li data-target="#myCarousel" data-slide-to="1"></li>
			<li data-target="#myCarousel" data-slide-to="2"></li>
		</ol>
		<!-- Wrapper for slides -->
		<div class="carousel-inner">
			<div class="item active">
				<img src="images/hospital.jpg" alt="hosital" style="width:100%;">
				<div class="carousel-caption">
					<h3></h3>
					<p></p>
				</div>
			</div>
			<div class="item">
				<img src="images/bed.jpg" alt="ico" style="width:100%;">
				<div class="carousel-caption" >
					<h3>Hitech Equipments</h3>
					<p>Because we care for you</p>
				</div>
			</div>
			<div class="item">
				<img src="images/docs.jpg" alt="our team" style="width:100%;">
				<div class="carousel-caption">
					<h3></h3>
					<p></p>
				</div>
			</div>
		</div>
		<!-- Left and right controls -->
		<a class="left carousel-control" href="#myCarousel" data-slide="prev">
			<span class="glyphicon glyphicon-chevron-left"></span>
			<span class="sr-only">Previous</span>
		</a>
		<a class="right carousel-control" href="#myCarousel" data-slide="next">
			<span class="glyphicon glyphicon-chevron-right"></span>
			<span class="sr-only">Next</span>
		</a>
	</div>

	<!--Footer-->
	<div class="jumbtron">
		
	</div>
	
<!--login model-->
<div class="modal fade" id="loginModal" role="dialog">
	<div class="modal-dialog modal-sm">
    	<div class="modal-content">
    		<div class="modal-header" style="background-color: purple; color: white;">
    			<button type="button" class="close" data-dismiss="modal">X</button>
    			Login
    		</div>
    		<div class="modal-body" style="background: #f1f1f1">
				<form id="form1">
					<div class="input-group ">
						<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
						<input id="email" type="text" class="form-control" placeholder="Email" required>
					</div> <br>
					<div class="input-group ">
						<span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
						<input id="password" type="password" class="form-control" placeholder="Password" required>
					</div> <br>
					<div class="row">
						<div class="col-xs-8">
							<div class="checkbox">
								<label>
									<input type="checkbox"> Remember Me
								</label>
							</div>
						</div>
						<div class="col-xs-4">
							<input type="submit" id="submit" value="Sign In" class="btn btn-primary btn-block btn-flat">
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<!--Register Modal-->
<div class="modal fade" id="registerModal" role="dialog">
	<div class="modal-dialog modal-md">
    	<div class="modal-content">
    		<div class="modal-header" style="background-color: purple; color: white;">
    			<button type="button" class="close" data-dismiss="modal">X</button>
    			<h4> Register </h4>
    		</div>
    		<div class="modal-body" style="background: #f1f1f1">
				<form id="form2">
					<div class="input-group">
    					<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
    					<input id="name" type="text" class="form-control" placeholder="Name" required>
    					<span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
    					<input id="email1" type="email" class="form-control" name="email" placeholder="Email" required>
    				</div> <br>
    				<div class="input-group">
    					<span class="input-group-addon"><i class="glyphicon glyphicon-home"></i></span>
    					<input type="text" id="address" class="form-control" placeholder="Address" required>
    				</div><br>
    				<div class="input-group">
    					<span class="input-group-addon"><i class="glyphicon glyphicon-tint"></i></span>
    					<select class="form-control" id="bgroup" name="bgroup" style="color: gray;" required>
    				    	<option value="">Blood Group</option>
    				    	<option value="A-">A-</option>
    				    	<option value="A+">A+</option>
    		    			<option value="B-">B-</option>
    		    			<option value="B+">B+</option>
    				    	<option value="AB-">AB-</option>
    				    	<option value="AB+">AB+</option>
    				    	<option value="O+">O+</option>
    				    	<option value="O-">O-</option>
						</select>
						<span class="input-group-addon"><i class="glyphicon glyphicon-resize-vertical"></i></span>
    					<input id="height" type="number" class="form-control" placeholder="Height(cms)" required>
    					<span class="input-group-addon"><i class="glyphicon glyphicon-dashboard"></i></span>
    					<input id="weight" type="number" class="form-control" placeholder="Weight(Kgs)" required>
    				</div> <br>
    				<div class="input-group">
    					<span class="input-group-addon"><i class="glyphicon glyphicon-heart"></i></span>
    					<input type="number" id="bp" class="form-control" placeholder="Blood Pressure" required>
    					<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
    					<input type="text" id="dob" class="form-control datepicker" placeholder="DOB(yyyy-mm-dd)" required>
    				</div> <br>
    				<div class="input-group">
    					<span class="input-group-addon"><i class="glyphicon glyphicon-glass"></i></span>
    					<label class="checkbox-inline form-control"><input type="checkbox" id="drink" value="alcoholic">Alcoholic</label>
    					<span class="input-group-addon"><i class="glyphicon glyphicon-fire"></i></span>
						<label class="checkbox-inline form-control"><input type="checkbox" id="smoker">Smoker</label>
						<span class="input-group-addon"><i class="glyphicon glyphicon-stop"></i></span>
						<label class="checkbox-inline form-control"><input type="checkbox" id="sugar" value="diabetic">diabetic</label>
						<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
						<div class="form-control">
    						<label class="radio-inline"><input name="gender" id="gender" type="radio" value="male" required> M </label>&nbsp; &nbsp;
    						<label class="radio-inline"><input name="gender" id="gender" type="radio" value="female" required> F </label>
    					</div>
					</div> <br>
    				<div class="input-group ">
    					<span class="input-group-addon"><i class="glyphicon glyphicon-phone"></i></span>
    					<input id="mobile" type="tel" class="form-control" name="mobile" placeholder="Mobile" required>
    					<span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
    					<input id="password1" type="password" class="form-control" name="password" placeholder="Password" required>
    				</div> <br>
    				<div class="row">
    		    		<div class="col-xs-8">
						</div>
						<div class="col-xs-4">
 							<button id="register" class="btn btn-primary btn-block btn-flat"> Register </button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	function createCookie(name,value,days) {
		if (days) {
			var date = new Date();
			date.setTime(date.getTime()+(days*24*60*60*1000));
			var expires = "; expires="+date.toGMTString();
		}
		else var expires = "";
		document.cookie = name+"="+value+expires+"; path=/";
	}

	function deleteCookie(name){
		createCookie(name, "", -1);
	}
	deleteCookie('hospital');
	deleteCookie('patient');
	deleteCookie('doctor');
$(function(){
	$('#dob').datepicker({
		maxDate:0,
		changeMonth: true,
		changeYear: true,
		dateFormat: 'yy-mm-dd',
		yearRange: '1940:2017'
	});
//to make the datepicker work on modal
$.fn.modal.Constructor.prototype.enforceFocus = function() {};

	$('#form1').submit(function(e){
		e.preventDefault();
		var email = $('#email').val();
		var password = $('#password').val();
		var dataa= JSON.stringify({'for':'login', 'email': email , 'password': password});
		console.log(dataa);

		$.ajax({
        url : 'server/login.php',
        type : 'post',
        data : {'myData':dataa},
        success : function(data1, status, xhr){
        	console.log(data1);
        	console.log(JSON.parse(data1));
        	var res= JSON.parse(data1);
        	if(res.success== true){
        	alert('welcome '+ res[0].name);
            var val="&name:"+res[0].name+"&email:"+res[0].email+" ";
            createCookie('patient', val, 1);
            console.log(document.cookie);
        	document.location.href= "patient.html";
          }
          else{
            alert(res.message);
          }
        },
        error: function(xhr, textStatus, error){
          alert('error occured'+error);
          //console.log(xhr+" "+ textStatus+" "+ error);
        }
      });
	});
	$('#form2').submit(function(e){
		e.preventDefault();
		var name=$('#name').val();
		var email1=$('#email1').val();
		var address=$('#address').val();
		var mobile=$('#mobile').val();
		var bgroup=$('#bgroup').val();
		var height=$('#height').val();
		var weight=$('#weight').val();
		var bp=$('#bp').val();
		var dob=$('#dob').val();
		var alchoholic=$('#drink').is(':checked');
		var gender= $('#gender:checked').val();
		var smoker=$('#smoker').is(':checked');
		var diabetic=$('#sugar').is(':checked');
		var password1=$('#password1').val();
		var rdata = JSON.stringify({'for':'register', 'name': name, 'email': email1, 'address': address, 'mobile':mobile, 'bgroup': bgroup, 'gender': gender, 'height': height, 'weight': weight, 'bp': bp, 'dob': dob, 'alchoholic': alchoholic, 'smoker': smoker, 'diabetic': diabetic, 'password': password1});
		console.log(rdata);

		$.ajax({
        url : 'server/login.php',
        type : 'post',
        data : {'myData':rdata},
        success : function(data1, status, xhr){
        	console.log(data1);
        	console.log(JSON.parse(data1));
        	var res= JSON.parse(data1);
        	if(res.success== true)
        	{
        		alert(res.message);
        		location.reload();
        	}
			else{
				alert(res.message);
			}
        },
        error: function(xhr, textStatus, error){
          alert('error occured'+error);
          //console.log(xhr+" "+ textStatus+" "+ error);
        }
      });
	});
});
</script>
</div>

</body>
</html>